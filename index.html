<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>IT 355 - Chatroom - Thang and Larry</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Thang and Larry">
    <link href="./css/bootstrap.css" rel="stylesheet">
	<script src="/socket.io/socket.io.js"></script>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript">
    	var socket = io.connect('/');
    	socket.on('from server', function (data) {
    		console.log(data);
    		if (data.message) {
    			var messagebox = document.getElementById("messagebox");
    			messagebox.innerHTML += (data.message);
    		} else {
    			console.log("Warn: get no message from server");
    		}
    	});

    	// var sendButton = document.getElementById("submitContent");
    	// sendButton.addEventListener("click", sendRequest, false);

    	function sendRequest() {

    		var messagebox = document.getElementById("messagebox");
    		var message = document.getElementById("messageinput").value;
    		var chatname = document.getElementById("userChatName").value;
    		var select = document.getElementById("selectroom");
    		var roomnumber = select.options[select.selectedIndex].value;

    		// display the user's input message
    		messagebox.innerHTML += message + "\n"
    		//send the special chat request
    		var address = socket.handshake.address;
    		console.log("~~~~~~~~~~~~The server address" + address);
    		// window.location = ;

    	}

		function gup(varname) {
			varname = varname.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
			var regexS = "[\\?&]"+varname+"=([^&#]*)";
			var regex = new RegExp( regexS );
			var results = regex.exec( window.location.href );
			if( results == null ) return ""; else return results[1];
		}
		
    </script>
  </head>
  <body>
	<div class="container" style="margin-top: 20px;">
		<div class="row">
			<div class="span12 lead" style="padding: 10px; border-radius:5px; background-color:gray">
				<font color="gold"><center><b>Welcome to our HTTP Chatroom ! </b></center></font>
			</div>
			<div class="span12" style="padding: 10px; margin-top: 15px; background-color:gray; border-radius:5px;">
				<font color="white">
				<div id="main" style="margin-left: 200px">
					<div float:left>Select Chatroom:
						<select id="selectroom">
						  <option value="1">Chatroom 1 (Default)</option>
						  <option value="2">Chatroom 2</option>
						  <option value="3">Chatroom 3 (VIP)</option>
						</select>
					</div>
					<div style="float:left">Your Chatname:
							<input type="text" id="userChatName" readonly="true"></input> 
							<button type="button" class="btn btn-info" onclick="document.getElementById('userChatName').readOnly = false;">Change Name</button>
					</div>
					<div style="float:left">
						Current Chatroom Content<br/>
						<textarea class="textarea" id="messagebox" readonly="readonly" rows="15" cols="90" style="overflow:auto; width:500px"></textarea>
					</div>
				    <div style="float:left">
						Send Content<br/>
						<textarea class="textarea" id="messageinput" rows="2" cols="90" style="overflow:auto; width:500px"></textarea>
						<div>
							<button type="button" class="btn btn-info" style="height: 35px; width: 150px" id="submitContent" onclick="sendRequest();">Submit</button>
							<button type="button" class="btn btn-warning" style="height: 35px; width: 150px" id="resetContent">Clear</button>
						</div>
					</div>
				</div>
				</select></font>
			</div>
		</div>	
	</div>
	
	<script src="./js/jquery.js"></script>
	<script src="./js/bootstrap.js"></script>
  </body>
</html>